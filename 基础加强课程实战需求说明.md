### 一、课程实战说明

#### 1、开发环境

`IDEA`和`JDK`

1. `IDEA`建议`IDEA2018`及以上。
2. `JDK`建议`JDK8`或`JDK11`。

#### 2、开发资料

`chatclient`: 基础项目的客户端。

`chatserver`: 基础项目的服务端。

同学们根据下列需求在已有的客户端和服务端代码上新增功能。

#### 3、演示视频

由实战指导老师现场演示。



#### 4、提交内容

同学们在基础代码上接着完成功能,今天晚上8点半提交代码.

提交方式：新建一个文件夹，文件夹的命名规则：`157-姓名`，将客户端和服务端代码放在这个文件夹中，打成压缩包，提交给实战指导老师。



### 二、客户端和服务端消息通信规则约定(简称通信码)

|   通信码   |   功能说明   |
| ---- | ---- |
| 100 | 表示登陆 |
| 101 | 表示注册 |
|     |        |
| 200 | 表示单聊 |
| 201 | 表示群聊 |
| 202 | 表示随机聊 |
|     |                     |
| 300 | 客户端获取已上线的所有用户 |
| 301 | 客户端获取上线用户根据用户名升序排序 |
| 302 | 客户端获取指定性别的上线用户 |

举例：
1. 客户端给服务端发送`100`，表示客户端要进行`登录`操作。
2. 客户端给服务端发送`201`，表示客户端要进行`群聊`操作。




### 三、开发功能说明

#### 1、服务器端

##### 1.1、获取已上线的所有用户

客户端向服务端发送通信码`300`，服务端获取所有的上线用户信息返回给客户端。

客户端效果如下：

```html
1.登陆
2.注册
3.单聊
4.群聊
5.随机聊
6.获取上线用户根据用户名升序排序
7.获取指定性别的上线用户
8.获取已上线的所有用户
9.退出
请输入你的选择：
8

你收到消息: 所有登陆用户:[User{userName = admin1, sex = 男, ip = 127.0.0.1, age = 50, admin = true}, User{userName = zhangsan, sex = 男, ip = null, age = 18, admin = false}, User{userName = wangwu, sex = 男, ip = null, age = 20, admin = false}, User{userName = admin2, sex = 女, ip = 127.0.0.1, age = 45, admin = true}, User{userName = lisi, sex = 女, ip = null, age = 22, admin = false}]
```



##### 1.2、获取上线用户根据用户名升序排序

客户端向服务端发送通信码`301`，服务端获取上线用户根据用户名升序排序返回给客户端

客户端效果如下：

```
1.登陆
2.注册
3.单聊
4.群聊
5.随机聊
6.获取上线用户根据用户名升序排序
7.获取指定性别的上线用户
8.获取已上线的所有用户
9.退出
请输入你的选择：
6

你收到消息: 根据用户名排序的用户:[User{userName = admin1, sex = 男, ip = 127.0.0.1, age = 50, admin = true}, User{userName = admin2, sex = 女, ip = 127.0.0.1, age = 45, admin = true}, User{userName = lisi, sex = 女, ip = null, age = 22, admin = false}, User{userName = wangwu, sex = 男, ip = null, age = 20, admin = false}, User{userName = zhangsan, sex = 男, ip = null, age = 18, admin = false}]
```



##### 1.3、获取指定性别的上线用户

当客户端输入的性别为 `男` 用户获取所有的线上男性用户；当客户端输入的性别为 `女` 获取所有的线上女性用户

客户端效果如下：

1. 客户端获取女性用户

    ```
    1.登陆
    2.注册
    3.单聊
    4.群聊
    5.随机聊
    6.获取上线用户根据用户名升序排序
    7.获取指定性别的上线用户
    8.获取已上线的所有用户
    9.退出
    请输入你的选择：
    7
    请输入要显示的性别：
    女

    你收到消息: 已上线的女姓用户:[User{userName = admin2, sex = 女, ip = 127.0.0.1, age = 45, admin = true}, User{userName = lisi, sex = 女, ip = null, age = 22, admin = false}]
    ```



2. 客户端获取男性用户

   ```
   1.登陆
   2.注册
   3.单聊
   4.群聊
   5.随机聊
   6.获取上线用户根据用户名升序排序
   7.获取指定性别的上线用户
   8.获取已上线的所有用户
   9.退出
   请输入你的选择：
   7
   请输入要显示的性别：
   男
   
   你收到消息: 已上线的男姓用户:[User{userName = admin1, sex = 男, ip = 127.0.0.1, age = 50, admin = true}, User{userName = zhangsan, sex = 男, ip = null, age = 18, admin = false}, User{userName = wangwu, sex = 男, ip = null, age = 20, admin = false}]
   ```

   



#### 2、客户端

##### 2.1、添加注册功能

用户注册的时候需要包含：用户名、性别、年龄等信息，用户的注册的信息会保存在服务端中，只有已经注册的用户才能登陆。

客户端效果如下：

```
请输服务端IP：
127.0.0.1
连接服务器成功!
1.登陆
2.注册
3.单聊
4.群聊
5.随机聊
6.获取上线用户根据用户名升序排序
7.获取指定性别的上线用户
8.获取已上线的所有用户
9.退出
请输入你的选择：
2
请输入注册的用户名称：
abcd
请输入注册的用户性别：
男
请输入注册的用户年龄：
22

你收到消息: 恭喜您:abcd, 注册成功!
```



如果用户名已经存在说明注册失败，效果如下：

```
xxx用户已经存在，注册失败!
```



##### 2.2、注册校验用户名

注册的用户名必须符合：首字母为a-z或A-Z，其它部分可以为字母、数字或者下划线；长度在10个字符以内

客户端效果如下：

```
1.登陆
2.注册
3.单聊
4.群聊
5.随机聊
6.获取上线用户根据用户名升序排序
7.获取指定性别的上线用户
8.获取已上线的所有用户
9.退出
请输入你的选择：
2
请输入注册的用户名称(首字母为a-z或A-Z,其它部分可以为字母、数字或者下划线，长度在10个字符以内)：
1abcd
您输入的用户名不符合要求,请重新输入!
aaaaaaaaaaa
您输入的用户名不符合要求,请重新输入!
aaaaaaa
请输入注册的用户性别：
女
请输入注册的用户年龄：
18
你收到消息: 恭喜您:aaaaaaa, 注册成功!
```

当用户名不符合要求时，再次让用户输入用户名，直到用户名输入正确。



##### 2.4、随机聊

客户端将消息随机发给一位在线用户。

效果如下：

一个客户端发起随机聊：

```
1.登陆
2.注册
3.单聊
4.群聊
5.随机聊
6.获取上线用户根据用户名升序排序
7.获取指定性别的上线用户
8.获取已上线的所有用户
9.退出
请输入你的选择：
5
请输入消息,将会随机发送给一个用户：
点兵点将,看缘分
```



另一个客户端：

```
你收到消息: 随机聊选中了你, lisi 对你说： 点兵点将,看缘分
```



#### 3、拓展

1. 客户端将自己收到的所有消息保存到文件，并提供查看历史聊天信息的功能。

2. 服务端把注册的用户保存到文件，并在服务端启动的时候加载已注册的用户信息。

3. 其他的功能扩展。


